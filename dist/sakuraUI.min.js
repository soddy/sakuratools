var sakuraUI,ver="1.0.0";(sakuraUI=sakuraUI||{}).ver=ver,function(o){o.cutFull=function(e){var t=stage.canvas.width,a=stage.canvas.height;e="png"==e?"image/png":"image/jpeg";var n=document.getElementById("animation_container"),i=window.devicePixelRatio,s=document.createElement("canvas");s.id="canvasTemp",s.width=t,s.height=a+parseInt(2*parseFloat(stage.canvas.style.top)*i),s.style.width=parseFloat(stage.canvas.style.width)+2*parseFloat(stage.canvas.style.left)+"px",s.style.height=parseFloat(stage.canvas.style.height)+2*parseFloat(stage.canvas.style.top)+"px",s.style.position="absolute",s.style.display="block",s.style.top="-5000px",n.appendChild(s);var r=s.getContext("2d"),o=Math.abs(parseFloat(stage.canvas.style.left)*i),t=Math.abs(parseFloat(stage.canvas.style.top)*i),a=stage.canvas.width-2*o,i=stage.canvas.height-2*t,i=stage.canvas.getContext("2d").getImageData(o,t,a,i);r.putImageData(i,0,0);e=s.toDataURL(e);return n.removeChild(s),e},o.cutPart=function(e,t,a,n,i,s){s="png"==s?"image/png":"image/jpeg";var r=window.devicePixelRatio,o=document.createElement("canvas"),l=e.viewRect.width,h=e.viewRect.height,c=e.canvas.width,d=e.canvas.height;o.id="canvasTemp",o.width=n/l*c,o.height=i/h*d,o.style.width=n/l*c/r+"px",o.style.height=i/h*d/r+"px",o.style.position="absolute",o.style.display="block",o.style.top="0px",o.style.left="0px",document.getElementById("animation_container").appendChild(o);r=o.getContext("2d"),a=e.canvas.getContext("2d").getImageData(t,a,o.width,o.height);r.putImageData(a,0,0);s=o.toDataURL(s);return o.remove(),s},o.cutExtent=function(){var i=this;document.getElementById("canvasExtent")&&document.getElementById("canvasExtent").remove(),i.x=0,i.y=0,i.w=0,i.h=0;var n=stage.canvas.cloneNode();n.id="canvasExtent",n.style["z-index"]=100,document.getElementById("animation_container").appendChild(n);var e=n.getContext("2d");e.fillStyle="rgba(192,192,192,0.5)",e.fillRect(0,0,n.width,n.height),n.addEventListener("touchstart",function(e){e=e.touches[0];s=(e.clientX+h)*o,r=(e.clientY+l)*o;e=this.getContext("2d");e.clearRect(0,0,this.width,this.height),e.fillStyle="rgba(192,192,192,0.5)",e.fillRect(0,0,n.width,n.height)},!1),n.addEventListener("touchmove",function(e){e.preventDefault();var t=e.touches[0],a=(t.clientX+h)*o,e=(t.clientY+l)*o,t=this.getContext("2d");t.lineWidth=1,t.clearRect(0,0,this.width,this.height),t.fillStyle="rgba(192,192,192,0.5)",t.fillRect(0,0,n.width,n.height),t.beginPath(),t.moveTo(s,r),t.lineTo(a,r),t.lineTo(a,e),t.lineTo(s,e),t.closePath(),t.stroke(),t.clearRect(s,r,a-s,e-r)},!1),n.addEventListener("touchend",function(e){var t=e.changedTouches[0],a=(t.clientX+h)*o,n=(t.clientY+l)*o,e=a-s,t=n-r;s<a&&r<n?(i.x=s,i.y=r):a<s&&r<n?(i.x=a,i.y=r):a<s&&n<r?(i.x=a,i.y=n):s<a&&n<r&&(i.x=s,i.y=n);i.w=Math.abs(e)*stage.viewRect.width/this.width,i.h=Math.abs(t)*stage.viewRect.height/this.height},!1);var s,r,o=window.devicePixelRatio,l=Math.abs(parseFloat(n.style.top)),h=Math.abs(parseFloat(n.style.left));this.remove=function(){n.remove()}},o.cutMc=function(){var e,r;return document.getElementById("canvasCutMc")||(window.devicePixelRatio,(e=document.createElement("canvas")).id="canvasCutMc",e.style.position="absolute",e.style.display="block",document.getElementById("animation_container").appendChild(e),r=window.stageCutMc=new sakura.Stage("canvasCutMc",750,1448,60,sakura.stageScaleMode.FIXED_BOTH,!0)),{loaded:function(t){r.addEventListener("loaded",function(e){t(!0)})},cut:function(e,t){var a=null==e.children[0].width?Object.create(e.children[0].parent):Object.create(e.children[0]),n=a.nominalBounds.width,i=a.nominalBounds.height,s=a.regX,e=a.regY;a.x=Math.abs(s),a.y=Math.abs(e),r.addChild(a),r.update();t=o.cutPart(r,0,0,n,i,t);return r.removeAllChildren(),t}}}}(sakuraUI=sakuraUI||{}),(sakuraUI||(sakuraUI={})).draw=function(){var o=this,e=stage.canvas.width,t=stage.canvas.height,a=new createjs.Shape;a.graphics.beginFill("#ffffff").drawRect(0,0,e,t),a.alpha=.01,stage.addChildAt(a,0),o.eraserOnOff=!1,o.replayOnOff=!0,o._startPoint={x:void 0,y:void 0},o._newPoint={x:void 0,y:void 0},o._endPoint={x:void 0,y:void 0},o._click=!1,o.s=[],o.eraserShape=new createjs.Shape,o.xArr=[],o.yArr=[],o.sArr=[],o.startTime=0,o.endTime=0,o.totalTimeStart=0,o.totalTimeEnd=0,o.totalTime=0;new createjs.Shape;stage.on("mousedown",function(e){o._click=!0,o._startPoint.x=e.stageX/stage.sRatio,o._startPoint.y=e.stageY/stage.sRatio,o.replayOnOff&&(o.startTime=o.totalTimeStart=Date.now(),o.sArr.push(0),o.xArr.push(o._startPoint.x),o.yArr.push(o._startPoint.y)),o.eraserOnOff&&(o.eraserShape.graphics.beginFill("#000000"),o.eraserShape.graphics.drawRect(o._startPoint.x-15,o._startPoint.y-15,30,30),o.eraserShape.graphics.endFill(),o.eraserShape.compositeOperation="destination-out",stage.addChild(o.eraserShape),stage.update())}),stage.on("pressmove",function(e){o._newPoint.x=e.stageX/stage.sRatio,o._newPoint.y=e.stageY/stage.sRatio,o.replayOnOff&&(o.endTime=Date.now(),o.sArr.push(o.endTime-o.startTime),o.xArr.push(o._newPoint.x),o.yArr.push(o._newPoint.y),o.startTime=Date.now()),o.eraserOnOff?(o.eraserShape.graphics.beginFill("#000000"),o.eraserShape.graphics.drawRect(o._newPoint.x-15,o._newPoint.y-15,30,30),o.eraserShape.graphics.endFill(),o.eraserShape.compositeOperation="destination-out",stage.addChild(o.eraserShape),stage.update()):(o._click&&(o.s.push(new createjs.Shape),o._click=!1),0<o.s.length&&((e=o.s[o.s.length-1]).graphics.beginStroke("green"),e.graphics.setStrokeStyle(5),e.graphics.moveTo(o._startPoint.x,o._startPoint.y),e.graphics.lineTo(o._newPoint.x,o._newPoint.y),e.graphics.endStroke(),stage.addChild(e),stage.update(),o._startPoint.x=o._newPoint.x,o._startPoint.y=o._newPoint.y))}),stage.on("pressup",function(e){o._click=!1,o._endPoint.x=e.stageX/stage.sRatio,o._endPoint.y=e.stageY/stage.sRatio,o.replayOnOff&&(o.endTime=o.totalTimeEnd=Date.now(),o.sArr.push(o.endTime-o.startTime),o.xArr.push(o._endPoint.x),o.yArr.push(o._endPoint.y),o.totalTime+=o.totalTimeEnd-o.totalTimeStart)}),o.cancel=function(){var e;0<o.s.length&&(e=o.s.pop(),stage.removeChild(e))},o.eraserControl=function(){o.eraserOnOff=!o.eraserOnOff},o.replayControl=function(){o.replayOnOff=!o.replayOnOff},o.getReplayInfo=function(){return{x:o.xArr,y:o.yArr,s:o.sArr}},o.replay=function(e){var t=0,a=e.x,n=e.y,i=e.s,e=o.totalTime/i.length,s=new createjs.Shape;s.graphics.setStrokeStyle(5);var r=setInterval(function(){t==a.length&&clearInterval(r),0==i[t]&&(s.graphics.beginStroke("green"),s.graphics.moveTo(a[t],n[t])),0==i[t+1]?s.graphics.endStroke():s.graphics.lineTo(a[t+1],n[t+1]),stage.addChild(s),stage.update(),t++},e)}},(sakuraUI||(sakuraUI={})).gesture=function(e,s,t,a){var n,i,r,o=0,l=[],h=!1,c=!1,d=!1,g={};if((a=a||!1)&&(e.canvas?(n=e.canvas.width,i=e.canvas.height,(r=new createjs.Shape).graphics.beginFill("#ffffff").drawRect(0,0,n,i),r.alpha=.01,stage.addChildAt(r,0)):(n=e.width,i=e.height,(r=new createjs.Shape).graphics.beginFill("#ffffff").drawRect(0,0,n,i),r.alpha=.01,r.x=e.nominalBounds.x,r.y=e.nominalBounds.y,e.addChildAt(r,0))),e==s)switch(t){case 0:d=c=h=!0;break;case 1:h=!0;break;case 2:c=!0;break;case 3:d=!0}else switch(t){case 0:d=c=!0;break;case 2:c=!0;break;case 3:d=!0}function p(){for(var e in o=0,l)l[e].start&&o++}function u(e,t){var a=t.x-e.x,e=t.y-e.y;return Math.sqrt(a*a+e*e)}e.on("mousedown",function(e){l[e.pointerID]={start:{x:e.stageX,y:e.stageY},current:{x:e.stageX,y:e.stageY},old:{x:e.stageX,y:e.stageY}},p(),1==o&&(g.x=s.x,g.y=s.y,g.rotation=s.rotation,g.scaleX=s.scaleX)}),e.on("pressmove",function(e){l[e.pointerID].current.x=e.stageX,l[e.pointerID].current.y=e.stageY,p(),1==o?h&&function(){var e,t=[];for(e in l)if(l[e].current&&(t.push(l[e]),1<=t.length))break;s.x=g.x+(t[0].current.x-t[0].old.x)/stage.sRatio,s.y=g.y+(t[0].current.y-t[0].old.y)/stage.sRatio}():(c&&function(){var e,t=[];for(e in l)if(l[e].current&&(t.push(l[e]),2<=t.length))break;var a=t[0].old,n=t[1].old,i=Math.atan2(a.y-n.y,a.x-n.x)*(180/Math.PI),a=t[0].current,n=t[1].current,n=Math.atan2(a.y-n.y,a.x-n.x)*(180/Math.PI);s.rotation=g.rotation+(n-i)}(),d&&function(){var e,t=[];for(e in l)if(l[e].current&&(t.push(l[e]),2<=t.length))break;var a=u(t[0].current,t[1].current)/u(t[0].old,t[1].old);s.scaleX=g.scaleX+a-1,s.scaleY=s.scaleX}())}),e.on("pressup",function(e){l[e.pointerID]&&delete l[e.pointerID],p(),0==o&&(g.x=s.x,g.y=s.y,g.rotation=s.rotation,g.scaleX=s.scaleX)})},(sakuraUI||(sakuraUI={})).scroll=function(C,M,R){R=R||1;var k=this;k.speedAddValue=10,k.stepAddValue=.95,k.scrollbarFlag=!0,k.init=function(){for(var a=new createjs.Container,e=new createjs.Shape,n=1==R?(e.graphics.beginFill("#000000").drawCircle(0,0,8),e.graphics.drawRect(-8,0,16,100),e.graphics.drawCircle(0,100,8),a.addChild(e),a.alpha=0,a.x=M.width-8,a.y=8,M.height-116):(e.graphics.beginFill("#000000").drawCircle(0,0,8),e.graphics.drawRect(0,-8,100,16),e.graphics.drawCircle(100,0,8),a.addChild(e),a.alpha=0,a.x=8,a.y=M.height-8,M.width-116),i=new createjs.Container,t=0,s=0,r=0;r<C.length;r++)1==R?(C[r].x=Math.abs(C[r].width/2),C[r].y=Math.abs(C[r].height/2)+t,t+=C[r].height):(C[r].x=Math.abs(C[r].width/2)+s,C[r].y=Math.abs(C[r].height/2),s+=C[r].width),i.addChild(C[r]);var o,e=new createjs.Shape;e.graphics.rect(0,0,M.width,M.height).closePath(),i.mask=e,M.addChild(e,i),k.scrollbarFlag&&M.addChild(a),stage.addChild(M);var l,h,c,d,g,p,u=0,y=0,v=0,w=0,f=0,x=0,m=0,b=void 0,I=0,T=0,_=!1;1==R?(p=M.height-t,M.on("mousedown",function(e){m=Date.now(),y=w=e.stageY/stage.sRatio,x=i.y,clearInterval(o)}),M.on("pressmove",function(e){_=!1,h=e.stageY/stage.sRatio,d=Math.abs(h-w),T=Date.now()-m,I=d/T,m=Date.now(),h!=w&&(b=h<w?0:1),w=h,i.y=x+(e.stageY/stage.sRatio-y),createjs.Tween.get(a).to({alpha:.5},10),a.y=8+Math.abs(i.y*n/Math.abs(p)),h-y<0?i.y<=p&&(i.y=p+.2*(i.y-p),a.y=M.height-116+8+(i.y-p),_=!0):0<=i.y&&(i.y*=.2,a.y=8+i.y,_=!0)}),M.on("pressup",function(e){var t=I*k.speedAddValue;_?(0<=i.y&&(createjs.Tween.get(a).wait(500).to({alpha:0},10),o=setInterval(function(){i.y-=10,a.y=8+i.y,i.y<=0&&(i.y=0,a.y=8+i.y,clearInterval(o))},10)),i.y<=p&&(createjs.Tween.get(a).wait(500).to({alpha:0},10),o=setInterval(function(){i.y+=10,a.y=M.height-116+8,i.y<=15+p&&(i.y=p,a.y=M.height-116+8,clearInterval(o)),clearInterval(o)},10))):o=0==b?(createjs.Tween.get(a).wait(1e3).to({alpha:0},10),setInterval(function(){i.y-=t,a.y=8+Math.abs(i.y*n/Math.abs(p)),i.y<=p&&(i.y=p,a.y=8+Math.abs(i.y*n/Math.abs(p)),clearInterval(o)),(t*=k.stepAddValue)<.001&&clearInterval(o)},10)):(createjs.Tween.get(a).wait(1e3).to({alpha:0},10),setInterval(function(){i.y+=t,a.y=8+Math.abs(i.y*n/Math.abs(p)),0<=i.y&&(i.y=0,clearInterval(o)),(t*=k.stepAddValue)<.001&&clearInterval(o)},10))})):(g=M.width-s,M.on("mousedown",function(e){m=Date.now(),u=v=e.stageX/stage.sRatio,f=i.x,clearInterval(o)}),M.on("pressmove",function(e){_=!1,l=e.stageX/stage.sRatio,c=Math.abs(l-v),T=Date.now()-m,I=c/T,m=Date.now(),l!=v&&(b=l<v?0:1),v=l,i.x=f+(e.stageX/stage.sRatio-u),createjs.Tween.get(a).to({alpha:.5},10),a.x=8+Math.abs(i.x*n/Math.abs(g)),l-u<0?i.x<=g&&(i.x=g+.2*(i.x-g),a.x=M.width-116+8+(i.x-g),_=!0):0<=i.x&&(i.x*=.2,a.x=8+i.x,_=!0)}),M.on("pressup",function(e){var t=I*k.speedAddValue;_?(0<=i.x&&(createjs.Tween.get(a).wait(500).to({alpha:0},10),o=setInterval(function(){i.x-=10,a.x=8+i.x,i.x<=0&&(i.x=0,a.x=8+i.x,clearInterval(o))},10)),i.x<=g&&(createjs.Tween.get(a).wait(500).to({alpha:0},10),o=setInterval(function(){i.x+=10,a.x=M.width-116+8,i.x<=15+g&&(i.x=g,a.x=M.width-116+8,clearInterval(o)),clearInterval(o)},10))):o=0==b?(createjs.Tween.get(a).wait(1e3).to({alpha:0},10),setInterval(function(){i.x-=t,a.x=8+Math.abs(i.x*n/Math.abs(g)),i.x<=g&&(i.x=g,a.x=8+Math.abs(i.x*n/Math.abs(g)),clearInterval(o)),(t*=k.stepAddValue)<.001&&clearInterval(o)},10)):(createjs.Tween.get(a).wait(1e3).to({alpha:0},10),setInterval(function(){i.x+=t,a.x=8+Math.abs(i.x*n/Math.abs(g)),0<=i.x&&(i.x=0,clearInterval(o)),(t*=k.stepAddValue)<.001&&clearInterval(o)},10))}))}},(sakuraUI||(sakuraUI={})).slide=function(P,S,j){j=j||1;this.init=function(t){for(var a=new createjs.Container,e=0,n=0,i=0;i<P.length;i++)1==j?(P[i].x=Math.abs(P[i].width/2),P[i].y=Math.abs(P[i].height/2)+e,e+=P[i].height):(P[i].x=Math.abs(P[i].width/2)+n,P[i].y=Math.abs(P[i].height/2),n+=P[i].width),a.addChild(P[i]);var s=new createjs.Shape;s.graphics.rect(0,0,S.width,S.height).closePath(),a.mask=s,S.addChild(s,a),stage.addChild(S);var r,o,l,h,c,d,g=0,p=0,u=0,y=0,v=0,w=0,f=0,x=void 0,m=0,b=0,I=1,T=1==j?S.height/2:S.width/2,_=S.y-S.regY,C=S.y+S.regY,M=S.x-S.regX,R=S.x+S.regX,k=!1;1==j?(d=S.height-e,S.on("mousedown",function(e){k||(f=Date.now(),p=y=e.stageY/stage.sRatio,w=a.y,clearInterval(void 0))}),S.on("pressmove",function(e){k||(o=e.stageY/stage.sRatio,h=Math.abs(o-y),b=Date.now()-f,m=h/b,f=Date.now(),o!=y&&(x=o<y?0:1),(y=o)<_||C<o||(a.y=w+(e.stageY/stage.sRatio-p),o-p<0?a.y<=d&&(a.y=d):0<=a.y&&(a.y=0)))}),S.on("pressup",function(e){if(!k)if(k=!0,m<.3)a.y>-(T+(I-1)*S.height)?createjs.Tween.get(a).to({y:-((I-1)*S.height)},150).call(function(){k=!1,--I<1&&(I=1),t(I)}):createjs.Tween.get(a).to({y:-(I*S.height)},150).call(function(){k=!1,++I>P.length&&(I=P.length),t(I)});else if(0==x){if(I==P.length)return void(k=!1);createjs.Tween.get(a).to({y:-(I*S.height)},150).call(function(){k=!1,++I>P.length&&(I=P.length),t(I)})}else{if(1==I)return void(k=!1);createjs.Tween.get(a).to({y:-((I-2)*S.height)},150).call(function(){k=!1,--I<1&&(I=1),t(I)})}})):(c=S.width-n,S.on("mousedown",function(e){k||(f=Date.now(),g=u=e.stageX/stage.sRatio,v=a.x,clearInterval(void 0))}),S.on("pressmove",function(e){k||(r=e.stageX/stage.sRatio,l=Math.abs(r-u),b=Date.now()-f,m=l/b,f=Date.now(),r!=u&&(x=r<u?0:1),(u=r)<M||R<r||(a.x=v+(e.stageX/stage.sRatio-g),r-g<0?a.x<=c&&(a.x=c):0<=a.x&&(a.x=0)))}),S.on("pressup",function(e){if(!k)if(k=!0,m<.3)a.x>-(T+(I-1)*S.width)?createjs.Tween.get(a).to({x:-((I-1)*S.width)},150).call(function(){k=!1,--I<1&&(I=1),t(I)}):createjs.Tween.get(a).to({x:-(I*S.width)},150).call(function(){k=!1,++I>P.length&&(I=P.length),t(I)});else if(0==x){if(I==P.length)return void(k=!1);createjs.Tween.get(a).to({x:-(I*S.width)},150).call(function(){k=!1,++I>P.length&&(I=P.length),t(I)})}else{if(1==I)return void(k=!1);createjs.Tween.get(a).to({x:-((I-2)*S.width)},150).call(function(){k=!1,--I<1&&(I=1),t(I)})}})),t(I)}},(sakuraUI||(sakuraUI={})).video=function(e){_url=e.url,_type=void 0===e.type?1:e.type,_scale=void 0===e.scale?1:e.scale,_time=void 0===e.time?.1:e.time,_totalTime=void 0===e.totalTime?0:e.totalTime;var t=(new Date).valueOf(),a=document.createElement("video");a.setAttribute("id","video"+t),a.setAttribute("muted",""),a.setAttribute("webkit-playsinline",!0),a.setAttribute("playsinline",!0),a.setAttribute("preload",!0),a.setAttribute("x5-video-player-type","h5-page"),a.setAttribute("style","width:100%; position:absolute; z-index:1; display:none;"),a.src=_url,document.body.append(a);var n=stage.canvas.width,i=stage.canvas.height,s=document.getElementById("animation_container"),r=window.devicePixelRatio,e=document.createElement("canvas");e.id="video"+t+"Canvas",e.width=n,e.height=i+parseInt(2*parseFloat(stage.canvas.style.top)*r),e.style.width=parseFloat(stage.canvas.style.width)+2*parseFloat(stage.canvas.style.left)+"px",e.style.height=parseFloat(stage.canvas.style.height)+2*parseFloat(stage.canvas.style.top)+"px",e.style.position="absolute",s.appendChild(e),this.videoTemp=a,this.videoCanvas=e,this.ctx=e.getContext("2d");var o=0;this.onPlay=function(){var e;1==_type&&(this.videoTemp.play(),stage.autoClear=!1,e=new createjs.Bitmap(this.videoTemp),stage.addChild(e),e.scaleX=_scale,e.scaleY=_scale)},this.onPlayFrames=function(){2==_type&&o<_totalTime&&(this.videoTemp.play(),this.videoTemp.pause(),o+=_time,this.videoTemp.currentTime=o,this.ctx.drawImage(this.videoTemp,0,0,n*_scale,i*_scale))}};