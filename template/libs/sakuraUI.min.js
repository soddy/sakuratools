var sakuraUI,ver="1.0.0";(sakuraUI||(sakuraUI={})).ver=ver,function(h){h.cutFull=function(e){var t=stage.canvas.width,a=stage.canvas.height;e="png"==e?"image/png":"image/jpeg";var n=document.getElementById("animation_container"),i=window.devicePixelRatio,s=document.createElement("canvas");s.id="canvasTemp",s.width=t,s.height=a+parseInt(2*parseFloat(stage.canvas.style.top)*i),s.style.width=parseFloat(stage.canvas.style.width)+2*parseFloat(stage.canvas.style.left)+"px",s.style.height=parseFloat(stage.canvas.style.height)+2*parseFloat(stage.canvas.style.top)+"px",s.style.position="absolute",s.style.display="block",s.style.top="-5000px",n.appendChild(s);var r=s.getContext("2d"),o=Math.abs(parseFloat(stage.canvas.style.left)*i),l=Math.abs(parseFloat(stage.canvas.style.top)*i),h=stage.canvas.width-2*o,c=stage.canvas.height-2*l,d=stage.canvas.getContext("2d").getImageData(o,l,h,c);r.putImageData(d,0,0);var g=s.toDataURL(e);return n.removeChild(s),g},h.cutPart=function(e,t,a,n,i,s){s="png"==s?"image/png":"image/jpeg";var r=window.devicePixelRatio,o=document.createElement("canvas"),l=e.viewRect.width,h=e.viewRect.height,c=e.canvas.width,d=e.canvas.height;o.id="canvasTemp",o.width=n/l*c,o.height=i/h*d,o.style.width=n/l*c/r+"px",o.style.height=i/h*d/r+"px",o.style.position="absolute",o.style.display="block",o.style.top="0px",o.style.left="0px",document.getElementById("animation_container").appendChild(o);var g=o.getContext("2d"),p=e.canvas.getContext("2d").getImageData(t,a,o.width,o.height);g.putImageData(p,0,0);var u=o.toDataURL(s);return o.remove(),u},h.cutExtent=function(){var r=this;document.getElementById("canvasExtent")&&document.getElementById("canvasExtent").remove(),r.x=0,r.y=0,r.w=0,r.h=0;var s=stage.canvas.cloneNode();s.id="canvasExtent",s.style["z-index"]=100,document.getElementById("animation_container").appendChild(s);var e=s.getContext("2d");e.fillStyle="rgba(192,192,192,0.5)",e.fillRect(0,0,s.width,s.height),s.addEventListener("touchstart",function(e){var t=e.touches[0];o=(t.clientX+d)*h,l=(t.clientY+c)*h;var a=this.getContext("2d");a.clearRect(0,0,this.width,this.height),a.fillStyle="rgba(192,192,192,0.5)",a.fillRect(0,0,s.width,s.height)},!1),s.addEventListener("touchmove",function(e){e.preventDefault();var t=e.touches[0],a=(t.clientX+d)*h,n=(t.clientY+c)*h,i=this.getContext("2d");i.lineWidth=1,i.clearRect(0,0,this.width,this.height),i.fillStyle="rgba(192,192,192,0.5)",i.fillRect(0,0,s.width,s.height),i.beginPath(),i.moveTo(o,l),i.lineTo(a,l),i.lineTo(a,n),i.lineTo(o,n),i.closePath(),i.stroke(),i.clearRect(o,l,a-o,n-l)},!1),s.addEventListener("touchend",function(e){var t=e.changedTouches[0],a=(t.clientX+d)*h,n=(t.clientY+c)*h,i=a-o,s=n-l;o<a&&l<n?(r.x=o,r.y=l):a<o&&l<n?(r.x=a,r.y=l):a<o&&n<l?(r.x=a,r.y=n):o<a&&n<l&&(r.x=o,r.y=n);r.w=Math.abs(i)*stage.viewRect.width/this.width,r.h=Math.abs(s)*stage.viewRect.height/this.height},!1);var o,l,h=window.devicePixelRatio,c=Math.abs(parseFloat(s.style.top)),d=Math.abs(parseFloat(s.style.left));this.remove=function(){s.remove()}},h.cutMc=function(){if(!document.getElementById("canvasCutMc")){window.devicePixelRatio;var e=document.createElement("canvas");e.id="canvasCutMc",e.style.position="absolute",e.style.display="block",document.getElementById("animation_container").appendChild(e);var l=window.stageCutMc=new sakura.Stage("canvasCutMc",750,1448,60,sakura.stageScaleMode.FIXED_BOTH,!0)}return{loaded:function(t){l.addEventListener("loaded",function(e){t(!0)})},cut:function(e,t){var a,n=(a=null==e.children[0].width?Object.create(e.children[0].parent):Object.create(e.children[0])).nominalBounds.width,i=a.nominalBounds.height,s=a.regX,r=a.regY;a.x=Math.abs(s),a.y=Math.abs(r),l.addChild(a),l.update();var o=h.cutPart(l,0,0,n,i,t);return l.removeAllChildren(),o}}}}(sakuraUI||(sakuraUI={})),(sakuraUI||(sakuraUI={})).draw=function(){var l=this,e=stage.canvas.width,t=stage.canvas.height,a=new createjs.Shape;a.graphics.beginFill("#ffffff").drawRect(0,0,e,t),a.alpha=.01,stage.addChildAt(a,0),l.eraserOnOff=!1,l.replayOnOff=!0,l._startPoint={x:void 0,y:void 0},l._newPoint={x:void 0,y:void 0},l._endPoint={x:void 0,y:void 0},l._click=!1,l.s=[],l.eraserShape=new createjs.Shape,l.xArr=[],l.yArr=[],l.sArr=[],l.startTime=0,l.endTime=0,l.totalTimeStart=0,l.totalTimeEnd=0,l.totalTime=0,new createjs.Shape,stage.on("mousedown",function(e){l._click=!0,l._startPoint.x=e.stageX/stage.sRatio,l._startPoint.y=e.stageY/stage.sRatio,l.replayOnOff&&(l.startTime=l.totalTimeStart=Date.now(),l.sArr.push(0),l.xArr.push(l._startPoint.x),l.yArr.push(l._startPoint.y)),l.eraserOnOff&&(l.eraserShape.graphics.beginFill("#000000"),l.eraserShape.graphics.drawRect(l._startPoint.x-15,l._startPoint.y-15,30,30),l.eraserShape.graphics.endFill(),l.eraserShape.compositeOperation="destination-out",stage.addChild(l.eraserShape),stage.update())}),stage.on("pressmove",function(e){if(l._newPoint.x=e.stageX/stage.sRatio,l._newPoint.y=e.stageY/stage.sRatio,l.replayOnOff&&(l.endTime=Date.now(),l.sArr.push(l.endTime-l.startTime),l.xArr.push(l._newPoint.x),l.yArr.push(l._newPoint.y),l.startTime=Date.now()),l.eraserOnOff)l.eraserShape.graphics.beginFill("#000000"),l.eraserShape.graphics.drawRect(l._newPoint.x-15,l._newPoint.y-15,30,30),l.eraserShape.graphics.endFill(),l.eraserShape.compositeOperation="destination-out",stage.addChild(l.eraserShape),stage.update();else if(l._click&&(l.s.push(new createjs.Shape),l._click=!1),0<l.s.length){var t=l.s[l.s.length-1];t.graphics.beginStroke("green"),t.graphics.setStrokeStyle(5),t.graphics.moveTo(l._startPoint.x,l._startPoint.y),t.graphics.lineTo(l._newPoint.x,l._newPoint.y),t.graphics.endStroke(),stage.addChild(t),stage.update(),l._startPoint.x=l._newPoint.x,l._startPoint.y=l._newPoint.y}}),stage.on("pressup",function(e){l._click=!1,l._endPoint.x=e.stageX/stage.sRatio,l._endPoint.y=e.stageY/stage.sRatio,l.replayOnOff&&(l.endTime=l.totalTimeEnd=Date.now(),l.sArr.push(l.endTime-l.startTime),l.xArr.push(l._endPoint.x),l.yArr.push(l._endPoint.y),l.totalTime+=l.totalTimeEnd-l.totalTimeStart)}),l.cancel=function(){if(0<l.s.length){var e=l.s.pop();stage.removeChild(e)}},l.eraserControl=function(){l.eraserOnOff=!l.eraserOnOff},l.replayControl=function(){l.replayOnOff=!l.replayOnOff},l.getReplayInfo=function(){return{x:l.xArr,y:l.yArr,s:l.sArr}},l.replay=function(e){var t=0,a=e.x,n=e.y,i=e.s,s=l.totalTime/i.length,r=new createjs.Shape;r.graphics.setStrokeStyle(5);var o=setInterval(function(){t==a.length&&clearInterval(o),0==i[t]&&(r.graphics.beginStroke("green"),r.graphics.moveTo(a[t],n[t])),0==i[t+1]?r.graphics.endStroke():r.graphics.lineTo(a[t+1],n[t+1]),stage.addChild(r),stage.update(),t++},s)}},(sakuraUI||(sakuraUI={})).gesture=function(e,r,t,a){var n=0,o=[],i=!1,s=!1,l=!1,h={};if(a=a||!1)if(e.canvas){var c=e.canvas.width,d=e.canvas.height;(g=new createjs.Shape).graphics.beginFill("#ffffff").drawRect(0,0,c,d),g.alpha=.01,stage.addChildAt(g,0)}else{var g;c=e.width,d=e.height,(g=new createjs.Shape).graphics.beginFill("#ffffff").drawRect(0,0,c,d),g.alpha=.01,g.x=e.nominalBounds.x,g.y=e.nominalBounds.y,e.addChildAt(g,0)}if(e==r)switch(t){case 0:l=s=i=!0;break;case 1:i=!0;break;case 2:s=!0;break;case 3:l=!0}else switch(t){case 0:l=s=!0;break;case 2:s=!0;break;case 3:l=!0}function p(){for(var e in n=0,o)o[e].start&&n++}function u(e,t){var a=t.x-e.x,n=t.y-e.y;return Math.sqrt(a*a+n*n)}e.on("mousedown",function(e){o[e.pointerID]={start:{x:e.stageX,y:e.stageY},current:{x:e.stageX,y:e.stageY},old:{x:e.stageX,y:e.stageY}},p(),1==n&&(h.x=r.x,h.y=r.y,h.rotation=r.rotation,h.scaleX=r.scaleX)}),e.on("pressmove",function(e){o[e.pointerID].current.x=e.stageX,o[e.pointerID].current.y=e.stageY,p(),1==n?i&&function(){var e=[];for(var t in o)if(o[t].current&&(e.push(o[t]),1<=e.length))break;r.x=h.x+(e[0].current.x-e[0].old.x)/stage.sRatio,r.y=h.y+(e[0].current.y-e[0].old.y)/stage.sRatio}():(s&&function(){var e=[];for(var t in o)if(o[t].current&&(e.push(o[t]),2<=e.length))break;var a=e[0].old,n=e[1].old,i=Math.atan2(a.y-n.y,a.x-n.x)*(180/Math.PI),a=e[0].current,n=e[1].current,s=Math.atan2(a.y-n.y,a.x-n.x)*(180/Math.PI);r.rotation=h.rotation+(s-i)}(),l&&function(){var e=[];for(var t in o)if(o[t].current&&(e.push(o[t]),2<=e.length))break;var a=u(e[0].current,e[1].current)/u(e[0].old,e[1].old);r.scaleX=h.scaleX+a-1,r.scaleY=r.scaleX}())}),e.on("pressup",function(e){o[e.pointerID]&&delete o[e.pointerID],p(),0==n&&(h.x=r.x,h.y=r.y,h.rotation=r.rotation,h.scaleX=r.scaleX)})},(sakuraUI||(sakuraUI={})).scroll=function(M,R,k){k=k||1;var P=this;P.speedAddValue=10,P.stepAddValue=.95,P.scrollbarFlag=!0,P.init=function(){var a,n=new createjs.Container,e=new createjs.Shape;a=1==k?(e.graphics.beginFill("#000000").drawCircle(0,0,8),e.graphics.drawRect(-8,0,16,100),e.graphics.drawCircle(0,100,8),n.addChild(e),n.alpha=0,n.x=R.width-8,n.y=8,R.height-116):(e.graphics.beginFill("#000000").drawCircle(0,0,8),e.graphics.drawRect(0,-8,100,16),e.graphics.drawCircle(100,0,8),n.addChild(e),n.alpha=0,n.x=8,n.y=R.height-8,R.width-116);for(var i=new createjs.Container,t=0,s=0,r=0;r<M.length;r++)1==k?(M[r].x=Math.abs(M[r].width/2),M[r].y=Math.abs(M[r].height/2)+t,t+=M[r].height):(M[r].x=Math.abs(M[r].width/2)+s,M[r].y=Math.abs(M[r].height/2),s+=M[r].width),i.addChild(M[r]);var o,l=new createjs.Shape;l.graphics.rect(0,0,R.width,R.height).closePath(),i.mask=l,R.addChild(l,i),P.scrollbarFlag&&R.addChild(n),stage.addChild(R);var h,c,d=0,g=0,p=0,u=0,v=0,y=0,w=0,f=0,x=0,m=void 0,b=0,I=0,T=0,_=0,C=!1;1==k?(c=R.height-t,R.on("mousedown",function(e){x=Date.now(),g=u=e.stageY/stage.sRatio,f=i.y,clearInterval(o)}),R.on("pressmove",function(e){C=!1,y=e.stageY/stage.sRatio,T=Math.abs(y-u),_=Date.now()-x,b=T/_,x=Date.now(),y!=u&&(m=y<u?0:1),u=y,i.y=f+(e.stageY/stage.sRatio-g),createjs.Tween.get(n).to({alpha:.5},10),n.y=8+Math.abs(i.y*a/Math.abs(c)),y-g<0?i.y<=c&&(i.y=c+.2*(i.y-c),n.y=R.height-116+8+(i.y-c),C=!0):0<=i.y&&(i.y*=.2,n.y=8+i.y,C=!0)}),R.on("pressup",function(e){var t=b*P.speedAddValue;C?(0<=i.y&&(createjs.Tween.get(n).wait(500).to({alpha:0},10),o=setInterval(function(){i.y-=10,n.y=8+i.y,i.y<=0&&(i.y=0,n.y=8+i.y,clearInterval(o))},10)),i.y<=c&&(createjs.Tween.get(n).wait(500).to({alpha:0},10),o=setInterval(function(){i.y+=10,n.y=R.height-116+8,i.y<=c+15&&(i.y=c,n.y=R.height-116+8,clearInterval(o)),clearInterval(o)},10))):o=0==m?(createjs.Tween.get(n).wait(1e3).to({alpha:0},10),setInterval(function(){i.y-=t,n.y=8+Math.abs(i.y*a/Math.abs(c)),i.y<=c&&(i.y=c,n.y=8+Math.abs(i.y*a/Math.abs(c)),clearInterval(o)),(t*=P.stepAddValue)<.001&&clearInterval(o)},10)):(createjs.Tween.get(n).wait(1e3).to({alpha:0},10),setInterval(function(){i.y+=t,n.y=8+Math.abs(i.y*a/Math.abs(c)),0<=i.y&&(i.y=0,clearInterval(o)),(t*=P.stepAddValue)<.001&&clearInterval(o)},10))})):(h=R.width-s,R.on("mousedown",function(e){x=Date.now(),d=p=e.stageX/stage.sRatio,w=i.x,clearInterval(o)}),R.on("pressmove",function(e){C=!1,v=e.stageX/stage.sRatio,I=Math.abs(v-p),_=Date.now()-x,b=I/_,x=Date.now(),v!=p&&(m=v<p?0:1),p=v,i.x=w+(e.stageX/stage.sRatio-d),createjs.Tween.get(n).to({alpha:.5},10),n.x=8+Math.abs(i.x*a/Math.abs(h)),v-d<0?i.x<=h&&(i.x=h+.2*(i.x-h),n.x=R.width-116+8+(i.x-h),C=!0):0<=i.x&&(i.x*=.2,n.x=8+i.x,C=!0)}),R.on("pressup",function(e){var t=b*P.speedAddValue;C?(0<=i.x&&(createjs.Tween.get(n).wait(500).to({alpha:0},10),o=setInterval(function(){i.x-=10,n.x=8+i.x,i.x<=0&&(i.x=0,n.x=8+i.x,clearInterval(o))},10)),i.x<=h&&(createjs.Tween.get(n).wait(500).to({alpha:0},10),o=setInterval(function(){i.x+=10,n.x=R.width-116+8,i.x<=h+15&&(i.x=h,n.x=R.width-116+8,clearInterval(o)),clearInterval(o)},10))):o=0==m?(createjs.Tween.get(n).wait(1e3).to({alpha:0},10),setInterval(function(){i.x-=t,n.x=8+Math.abs(i.x*a/Math.abs(h)),i.x<=h&&(i.x=h,n.x=8+Math.abs(i.x*a/Math.abs(h)),clearInterval(o)),(t*=P.stepAddValue)<.001&&clearInterval(o)},10)):(createjs.Tween.get(n).wait(1e3).to({alpha:0},10),setInterval(function(){i.x+=t,n.x=8+Math.abs(i.x*a/Math.abs(h)),0<=i.x&&(i.x=0,clearInterval(o)),(t*=P.stepAddValue)<.001&&clearInterval(o)},10))}))}},(sakuraUI||(sakuraUI={})).slide=function(P,S,j){j=j||1,this.init=function(t){for(var a=new createjs.Container,e=0,n=0,i=0;i<P.length;i++)1==j?(P[i].x=Math.abs(P[i].width/2),P[i].y=Math.abs(P[i].height/2)+e,e+=P[i].height):(P[i].x=Math.abs(P[i].width/2)+n,P[i].y=Math.abs(P[i].height/2),n+=P[i].width),a.addChild(P[i]);var s=new createjs.Shape;s.graphics.rect(0,0,S.width,S.height).closePath(),a.mask=s,S.addChild(s,a),stage.addChild(S);var r,o,l=0,h=0,c=0,d=0,g=0,p=0,u=0,v=0,y=0,w=void 0,f=0,x=0,m=0,b=0,I=1,T=1==j?S.height/2:S.width/2,_=S.y-S.regY,C=S.y+S.regY,M=S.x-S.regX,R=S.x+S.regX,k=!1;1==j?(o=S.height-e,S.on("mousedown",function(e){k||(y=Date.now(),h=d=e.stageY/stage.sRatio,v=a.y,clearInterval(void 0))}),S.on("pressmove",function(e){k||(p=e.stageY/stage.sRatio,m=Math.abs(p-d),b=Date.now()-y,f=m/b,y=Date.now(),p!=d&&(w=p<d?0:1),(d=p)<_||C<p||(a.y=v+(e.stageY/stage.sRatio-h),p-h<0?a.y<=o&&(a.y=o):0<=a.y&&(a.y=0)))}),S.on("pressup",function(e){if(!k)if(k=!0,f<.3)a.y>-(T+(I-1)*S.height)?createjs.Tween.get(a).to({y:-(I-1)*S.height},150).call(function(){k=!1,--I<1&&(I=1),t(I)}):createjs.Tween.get(a).to({y:-I*S.height},150).call(function(){k=!1,++I>P.length&&(I=P.length),t(I)});else if(0==w){if(I==P.length)return void(k=!1);createjs.Tween.get(a).to({y:-I*S.height},150).call(function(){k=!1,++I>P.length&&(I=P.length),t(I)})}else{if(1==I)return void(k=!1);createjs.Tween.get(a).to({y:-(I-2)*S.height},150).call(function(){k=!1,--I<1&&(I=1),t(I)})}})):(r=S.width-n,S.on("mousedown",function(e){k||(y=Date.now(),l=c=e.stageX/stage.sRatio,u=a.x,clearInterval(void 0))}),S.on("pressmove",function(e){k||(g=e.stageX/stage.sRatio,x=Math.abs(g-c),b=Date.now()-y,f=x/b,y=Date.now(),g!=c&&(w=g<c?0:1),(c=g)<M||R<g||(a.x=u+(e.stageX/stage.sRatio-l),g-l<0?a.x<=r&&(a.x=r):0<=a.x&&(a.x=0)))}),S.on("pressup",function(e){if(!k)if(k=!0,f<.3)a.x>-(T+(I-1)*S.width)?createjs.Tween.get(a).to({x:-(I-1)*S.width},150).call(function(){k=!1,--I<1&&(I=1),t(I)}):createjs.Tween.get(a).to({x:-I*S.width},150).call(function(){k=!1,++I>P.length&&(I=P.length),t(I)});else if(0==w){if(I==P.length)return void(k=!1);createjs.Tween.get(a).to({x:-I*S.width},150).call(function(){k=!1,++I>P.length&&(I=P.length),t(I)})}else{if(1==I)return void(k=!1);createjs.Tween.get(a).to({x:-(I-2)*S.width},150).call(function(){k=!1,--I<1&&(I=1),t(I)})}})),t(I)}},(sakuraUI||(sakuraUI={})).video=function(e){_url=e.url,_type=void 0===e.type?1:e.type,_scale=void 0===e.scale?1:e.scale,_time=void 0===e.time?.1:e.time,_totalTime=void 0===e.totalTime?0:e.totalTime;var t=(new Date).valueOf(),a=document.createElement("video");a.setAttribute("id","video"+t),a.setAttribute("muted",""),a.setAttribute("webkit-playsinline",!0),a.setAttribute("playsinline",!0),a.setAttribute("preload",!0),a.setAttribute("x5-video-player-type","h5-page"),a.setAttribute("style","width:100%; position:absolute; z-index:1; display:none;"),a.src=_url,document.body.append(a);var n=stage.canvas.width,i=stage.canvas.height,s=document.getElementById("animation_container"),r=window.devicePixelRatio,o=document.createElement("canvas");o.id="video"+t+"Canvas",o.width=n,o.height=i+parseInt(2*parseFloat(stage.canvas.style.top)*r),o.style.width=parseFloat(stage.canvas.style.width)+2*parseFloat(stage.canvas.style.left)+"px",o.style.height=parseFloat(stage.canvas.style.height)+2*parseFloat(stage.canvas.style.top)+"px",o.style.position="absolute",s.appendChild(o),this.videoTemp=a,this.videoCanvas=o,this.ctx=o.getContext("2d");var l=0;this.onPlay=function(){if(1==_type){this.videoTemp.play(),stage.autoClear=!1;var e=new createjs.Bitmap(this.videoTemp);stage.addChild(e),e.scaleX=_scale,e.scaleY=_scale}},this.onPlayFrames=function(){2==_type&&l<_totalTime&&(this.videoTemp.play(),this.videoTemp.pause(),l+=_time,this.videoTemp.currentTime=l,this.ctx.drawImage(this.videoTemp,0,0,n*_scale,i*_scale))}};